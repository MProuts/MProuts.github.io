
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ruby Encoding: From the Top - Full Stack Snacks</title>
  <meta name="author" content="Michael Prouty">

  
  <meta name="description" content="As web developers, we spend a lot of time dealing with strings. We receive strings from
clients, we process requests based on the content of those &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://MProuts.github.io/blog/2014/08/29/binary-encoding-in-ruby-ascii-8bit/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Full Stack Snacks" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-50683410-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Full Stack Snacks</a></h1>
  
    <h2>One byte at a time.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:MProuts.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Ruby Encoding: From the Top</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-29T14:17:41-04:00" pubdate data-updated="true">Aug 29<span>th</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>As web developers, we spend a lot of time dealing with strings.  We receive strings from
clients, we process requests based on the content of those strings, we
use programming languages and frameworks to build up large, elaborate
response strings, and we send them back to the client.</p>

<h1>WTF Are Strings?</h1>

<p>Let&rsquo;s pretend it&rsquo;s day one of our programming careers again.  We&rsquo;re
excitedly staring into our first REPL, feeling like a total hacker
badass to be behind the curtain of the kushi GUI for the first time.
In Ruby, (as in any programming language) the first thing you learn how
to do it is grab hold of a string literal, and print it to the screen.</p>

<pre><code>puts "Hello World!"
</code></pre>

<p>But the explanation ends there &mdash; a string is a sort of thing in
programming that you can print and it looks like words.  The lesson goes
on to explain that you can do different things with strings than you can
with integers.  Enter integers, enter arithetic, enter string
concatenation.</p>

<h1>But WTF is a String?</h1>

<p>But let&rsquo;s pause for a minute and consider what&rsquo;s missing from that
initial explanation of <code>"Hello World!"</code>.</p>

<p>We know that on a basic level, everything that a computer understands is
essentially zeros and ones.  We also know that these for the most part
come in 8-packs called bytes.</p>

<h4>Byte (8-packs of bits)</h4>

<blockquote><p>00000000</p>

<p>11111111</p>

<p>00001111</p></blockquote>

<p>Strings are no exception to this fundamental law.  In Ruby, we can get
ahold of these individual 8-packs using the String#bytes method.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">irb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="s2">&quot;Hello!&quot;</span><span class="o">.</span><span class="n">bytes</span>
</span><span class='line'>     <span class="o">=&gt;</span> <span class="o">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">33</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>But wait, those don&rsquo;t look like the ones from our previous example.
Turns out, integers in ruby are always base-10.  So how do we get our
hands on those familiar zeros and ones?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">irb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="s2">&quot;H&quot;</span><span class="o">.</span><span class="n">bytes</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">byte</span><span class="o">|</span> <span class="n">byte</span><span class="o">.</span><span class="n">to_s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>     <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;1001000&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>By calling <code>to_s(2)</code> the byte, we get a
<em>string representation</em> of a base-2 values (NOT the values themselves).</p>

<p>But what if we want to materialize a byte by typing the
base-2 representation rather than the base-10?</p>

<h3>The Literals They Don&rsquo;t Teach You: Hexadecimal, Octal, Binary</h3>

<p>There&rsquo;s literals for that.  Ruby provides three literals for alternatives to base-10
notation (which often come up when dealing with binary).  As you can see
by their return values, the following are equivalent:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># String Literal</span>
</span><span class='line'><span class="s2">&quot;Q&quot;</span><span class="o">.</span><span class="n">bytes</span><span class="o">.</span><span class="n">first</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">81</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Binary Literal (Base-2)</span>
</span><span class='line'><span class="m-Bin">0b1010001</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">81</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Octal Literal (Base-8)</span>
</span><span class='line'><span class="mo">0121</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">81</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Hexadecimal Literal (Base-16)</span>
</span><span class='line'><span class="mh">0x51</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">81</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that while you may input values using these literals for
convenience, Ruby always outputs Fixnums in base-10.</p>

<p>So we&rsquo;re a little bit closer.  Now we know that we can create a specific
byte in memory using a variety of different literals.  We know that on
the output side, Ruby will always return the same byte as a base-10
fixnum, and that we may print an <strong><em>inequivalent</em></strong> <em>string
representation</em> of the byte in what ever base we chose using <code>fixnum#to_s(base)</code>.</p>

<p>We&rsquo;re now equipped to see how strings rest on top of these bytes.</p>

<h1>WTF is a String?</h1>

<p>A string is a series of <em>encoded</em> bytes.  Given the following string of
bits:</p>

<blockquote><p>1001101110010111011111110111</p></blockquote>

<p>Your computer splits it up into 8-bit chunks</p>

<blockquote><p>1001101 1100101 1101111 1110111</p></blockquote>

<p>And takes each of those 8 chunks to mean some other thing.  What these
chunks map to is defined by an encoding scheme.</p>

<p>Let&rsquo;s pretend we&rsquo;re the computer for a hot second.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bytes</span> <span class="o">=</span> <span class="o">[</span> <span class="m-Bin">0b1001101</span><span class="p">,</span> <span class="m-Bin">0b1100101</span><span class="p">,</span> <span class="m-Bin">0b1101111</span><span class="p">,</span> <span class="m-Bin">0b1110111</span> <span class="o">]</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="mi">77</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">119</span><span class="o">]</span> <span class="c1"># That&#39;s expected -- base-10 Fixnums in Ruby</span>
</span><span class='line'>
</span><span class='line'><span class="n">chars</span> <span class="o">=</span> <span class="n">bytes</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">byte</span><span class="o">|</span> <span class="n">byte</span><span class="o">.</span><span class="n">chr</span> <span class="p">}</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="o">]</span> <span class="c1"># Maybe you see where this is going...</span>
</span><span class='line'>
</span><span class='line'><span class="n">string</span> <span class="o">=</span> <span class="n">chars</span><span class="o">.</span><span class="n">join</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="s2">&quot;Meow&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Pat yourself on the back.  You just acted like a computer.</p>

<p>The <code>char()</code> method on line 4 does the work of transforming bytes
into strings by applying an <em>encoding</em>.  We haven&rsquo;t given it an encoding
scheme to use, so it uses ASCII_US by default.</p>

<p>-different encoding schemes
-not all bytes live on all encoding schemes
-ascii-8bit (gives you the hex of the binary)
-string binary literals (add that to the list from earier)</p>

<h1>Multi-byte strings</h1>

<p>pack and unpack</p>

<h1>String Escape Codes</h1>

<p>&ldquo;\xBD&rdquo;</p>

<p>&ldquo;\uE9&rdquo;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">irb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="s2">&quot;</span><span class="se">\xFF</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
</span><span class='line'><span class="ss">Encoding</span><span class="p">:</span><span class="ss">:InvalidByteSequenceError</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\xFF</span><span class="s2">&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>For strings where underlying bytes aren&rsquo;t encoded &mdash; only for encodings
what permit.</p>

<h1>Encodings</h1>

<p>Just a scheme for mapping bytes to characters to print/display.</p>

<p>Encoding::ISO_8859_1 # HTML 4</p>

<p>ASCII-8BIT</p>

<p>Encoding.list
Encoding.name_list</p>

<p>Pacng::ASCII_8BIT is a special encoding that is usually used for a byte
string, not a character string. But as the name insists, its characters</p>

<h1>in the range of ASCII are considered as ASCII charactersk and Unpack</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">(</span><span class="n">irb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">72</span><span class="o">.</span><span class="n">to_s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>     <span class="o">=&gt;</span> <span class="s2">&quot;1001000&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s important to note that the value returned here is a &ldquo;string
representation&rdquo; meaning that it no longer actually stores value of 72.
Rather, we traded a base-10 representation a single byte for 7</p>

<p>To see a base-2 representation of integer representation of the base-2
binary bytes that the computer is actually holding in memory.</p>

<h1>Binary type and ASCII-8BIT</h1>

<p>Binary vs. Octal vs. Hex vs. Decimal</p>

<p>Octal is base 8. Octal lets you three-digit chunks of binary as single digits.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Michael Prouty</span></span>

      








  


<time datetime="2014-08-29T14:17:41-04:00" pubdate data-updated="true">Aug 29<span>th</span>, 2014</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://MProuts.github.io/blog/2014/08/29/binary-encoding-in-ruby-ascii-8bit/" data-via="" data-counturl="http://MProuts.github.io/blog/2014/08/29/binary-encoding-in-ruby-ascii-8bit/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/08/03/add-ansi-colors-to-your-motd-with-vim/" title="Previous Post: add ANSI colors to your motd (with vim!)">&laquo; add ANSI colors to your motd (with vim!)</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  <style>
<style>
  .ig-b- { display: inline-block; }
  .ig-b- img { visibility: hidden; }
  .ig-b-:hover { background-position: 0 -60px; } .ig-b-:active { background-position: 0 -120px; }
  .ig-b-16 { width: 16px; height: 16px; background: url(//badges.instagram.com/static/images/ig-badge-sprite-16.png) no-repeat 0 0; }
  @media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2 / 1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx) {
  .ig-b-16 { background-image: url(//badges.instagram.com/static/images/ig-badge-sprite-16@2x.png); background-size: 60px 178px; } }
  .gravatar p { margin:0px }
  .gravatar > .text, .image { float:left }
  .gravatar .name { font-weight:bold;margin-top:4px; }
  .gravatar .text { margin-left:5px; }
  .badge { display:block;margin-bottom:3px; }
  .clearfix { display:block;clear:both;visibility:hidden; }
</style>
<section>
	<span class="gravatar">
		<img class="image" src="http://www.gravatar.com/avatar/c0181972be1b5d6dce3cbea1a0fa99d8" alt="Gravatar of Michael Prouty " title="Gravatar of Michael Prouty" />
    <span class="text">
      <p class="name">Michael Prouty</p>
      <a href="http://instagram.com/_mprouts?ref=badge" class="ig-b- ig-b-16 badge"><img src="//badges.instagram.com/static/images/ig-badge-16.png" alt="Instagram" /></a><p></p>
      <p>Ruby Developer</p>
      <p><a href="http://logcheck.com" target="_blank">LogCheck</a></p>
    </span>
    <span class="clearfix">.</span>
	</span>
</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/29/binary-encoding-in-ruby-ascii-8bit/">Ruby Encoding: From the Top</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/03/add-ansi-colors-to-your-motd-with-vim/">Add ANSI Colors to Your Motd (With Vim!)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/15/addressing-ip/">Addressing IP</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/20/check-for-stray-binding-dot-prys-before-commit/">Check for Stray Pry Calls Before Commit</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/01/cross-domain-post-and-delete-with-jquery-and-rails/">Cross-Domain Requests With Angular & Rails</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Michael Prouty -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>. Design by <a href="http://octopressthemes.com">Octopress Themes</a>.</span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
